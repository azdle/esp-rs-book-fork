<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Ecosystem Overview - The Rust on ESP Book</title>


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A comprehensive guide on using the Rust programming language with Espressif SoCs and modules">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="overview.html" class="active"><strong aria-hidden="true">2.</strong> Ecosystem Overview</a></li><li class="chapter-item expanded "><a href="getting-started/index.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="getting-started/installing-rust.html"><strong aria-hidden="true">3.1.</strong> Installing Rust</a></li><li class="chapter-item expanded "><a href="getting-started/creating-applications.html"><strong aria-hidden="true">3.2.</strong> Creating Applications</a></li></ol></li><li class="chapter-item expanded "><a href="tooling/index.html"><strong aria-hidden="true">4.</strong> Tooling</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tooling/text-editors-and-ides.html"><strong aria-hidden="true">4.1.</strong> Text Editors and IDEs</a></li><li class="chapter-item expanded "><a href="tooling/espflash.html"><strong aria-hidden="true">4.2.</strong> espflash</a></li><li class="chapter-item expanded "><a href="tooling/espmonitor.html"><strong aria-hidden="true">4.3.</strong> espmonitor</a></li><li class="chapter-item expanded "><a href="tooling/debugging/index.html"><strong aria-hidden="true">4.4.</strong> Debugging</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tooling/debugging/probe-rs.html"><strong aria-hidden="true">4.4.1.</strong> probe-rs</a></li><li class="chapter-item expanded "><a href="tooling/debugging/openocd.html"><strong aria-hidden="true">4.4.2.</strong> OpenOCD</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item expanded "><a href="misc/glossary.html">Appendix A: Glossary</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust on ESP Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/esp-rs/book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ecosystem-overview"><a class="header" href="#ecosystem-overview">Ecosystem Overview</a></h1>
<p>As it stands there are two approaches for using Rust on Espressif chips, <code>std</code> and <code>no_std</code>. Both approaches have their advantages and disadvantages, so you should choose one based on your project's needs. Below is an overview of the two approaches followed by a brief comparison between them.</p>
<p>The <a href="https://github.com/esp-rs/">esp-rs organization</a> on GitHub is home to a number of repositories related to running Rust on Espressif chips. Most of the required crates have their source code hosted here.</p>
<h2 id="using-the-rust-standard-library-std"><a class="header" href="#using-the-rust-standard-library-std">Using the Rust Standard Library (<code>std</code>)</a></h2>
<p>Espressif provides a C-based development framework called <a href="https://github.com/espressif/esp-idf"><code>esp-idf</code></a> which has support for Espressif chips from the ESP32 and later. <code>esp-idf</code> provides a <a href="https://sourceware.org/newlib/">newlib</a> environment with enough functionality to build the Rust standard library (<code>std</code>) on top of it, hence this approach. The supported <code>std</code> features are as follows:</p>
<ul>
<li>Threads</li>
<li>Mutexes and other synchronization primitives</li>
<li>Collections</li>
<li>Random number generation</li>
<li>Sockets</li>
</ul>
<p>On top of <code>std</code> features, there is a <a href="https://github.com/esp-rs/embedded-svc">embedded-svc</a> implementation for <code>esp-idf</code> which adds extra support for services/modules not available in the standard library, including:</p>
<ul>
<li>Wi-Fi management</li>
<li>NVS (non-volatile storage)</li>
<li>Networking services like <code>httpd</code> and <code>ping</code></li>
</ul>
<p>In general, this approach should feel quite similar to developing for most normal PC environments.</p>
<h3 id="chip-support"><a class="header" href="#chip-support">Chip Support</a></h3>
<p>Chip support for <code>std</code> requires two things, LLVM/Clang support and support in <code>esp-idf</code>. Refer to the table below to see if your chip is supported.</p>
<table><thead><tr><th align="center">Chip</th><th align="center">Supported?</th></tr></thead><tbody>
<tr><td align="center">ESP32</td><td align="center">✅</td></tr>
<tr><td align="center">ESP32-C3</td><td align="center">✅</td></tr>
<tr><td align="center">ESP32-S2</td><td align="center">✅</td></tr>
<tr><td align="center">ESP32-S3</td><td align="center">✅</td></tr>
<tr><td align="center">ESP32-H2</td><td align="center">planned</td></tr>
<tr><td align="center">ESP8266</td><td align="center">❌</td></tr>
</tbody></table>
<h3 id="relevant-esp-rs-crates"><a class="header" href="#relevant-esp-rs-crates">Relevant <code>esp-rs</code> crates</a></h3>
<table><thead><tr><th>Repository</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://github.com/esp-rs/embedded-svc">esp-rs/embedded-svc</a></td><td>Abstraction traits for embedded services.</td></tr>
<tr><td><a href="https://github.com/esp-rs/esp-idf-svc">esp-rs/esp-idf-svc</a></td><td>An implementation of <a href="https://github.com/esp-rs/embedded-svc">embedded-svc</a> using <code>esp-idf</code> drivers.</td></tr>
<tr><td><a href="https://github.com/esp-rs/esp-idf-sys">esp-rs/esp-idf-sys</a></td><td>Rust bindings to the <code>esp-idf</code> development framework. Gives raw (<code>unsafe</code>) access to drivers, Wi-Fi and more.</td></tr>
<tr><td><a href="https://github.com/esp-rs/esp-idf-hal">esp-rs/esp-idf-hal</a></td><td>An implementation of the <code>embedded-hal</code> traits using the <code>esp-idf</code> framework.</td></tr>
</tbody></table>
<h2 id="bare-metal-no_std"><a class="header" href="#bare-metal-no_std">Bare Metal (<code>no_std</code>)</a></h2>
<p>Using <code>no_std</code> may be more familiar to embedded Rust developers. It does not use <code>std</code> (the Rust standard library) but instead uses a subset, the <code>core</code> library. The <a href="https://docs.rust-embedded.org/">official Rust embedded book</a> has a <a href="https://docs.rust-embedded.org/book/intro/no-std.html">great section on this</a>.</p>
<p>It's important to note that in general a <code>no_std</code> crate can always compile in <code>std</code> environment but the inverse is not true, therefore when creating crates it's worth keeping in mind if it needs to the standard library to function.</p>
<p>The main focus of the <code>no_std</code> ESP support has been around the ESP32 and to a lesser extent the ESP8266. As <a href="https://github.com/espressif/svd">SVDs are released</a> it will be possible to create hardware abstraction layers (HAL) for newer chips.</p>
<p>While <code>esp32-hal</code> has great support for a lot of the onboard peripherals, Wi-Fi and Bluetooth are <strong>not</strong> currently supported in a <code>no_std</code> enviroment. <a href="https://github.com/esp-rs/esp32-wifi">esp-wifi</a> was created to explore getting it working, but it is not yet functional.</p>
<h3 id="chip-support-1"><a class="header" href="#chip-support-1">Chip Support</a></h3>
<p>Chip support for <code>no_std</code> requires LLVM/Clang support just like for <code>std</code>. However, this has no dependency on <code>esp-idf</code>. In addition to compiler support, it's necessary to have peripheral access crates (PAC) and hardware abstraction layers (HAL) for your desired chip.</p>
<p>Refer to the table below to see if your chip is supported.</p>
<table><thead><tr><th align="center">Chip</th><th align="center">PAC</th><th align="center">HAL</th></tr></thead><tbody>
<tr><td align="center">ESP32</td><td align="center">✅</td><td align="center">✅</td></tr>
<tr><td align="center">ESP32-C3</td><td align="center">✅</td><td align="center">planned</td></tr>
<tr><td align="center">ESP32-S2</td><td align="center">⚠️</td><td align="center">planned</td></tr>
<tr><td align="center">ESP32-S3</td><td align="center">⚠️</td><td align="center">planned</td></tr>
<tr><td align="center">ESP32-H2</td><td align="center">planned</td><td align="center">planned</td></tr>
<tr><td align="center">ESP8266</td><td align="center">✅</td><td align="center">✅</td></tr>
</tbody></table>
<p><strong>Note:</strong> <em>items marked with ⚠️ have repositories, but have not yet been published to <a href="https://crates.io/">crates.io</a>.</em></p>
<h3 id="relevant-esp-rs-crates-1"><a class="header" href="#relevant-esp-rs-crates-1">Relevant <code>esp-rs</code> Crates</a></h3>
<table><thead><tr><th>Repository</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://github.com/esp-rs/esp32-hal">esp-rs/esp32-hal</a></td><td>An implementation of the <code>embedded-hal</code> traits and more for the ESP32.</td></tr>
<tr><td><a href="https://github.com/esp-rs/esp32">esp-rs/esp32</a></td><td>A PAC crate for the ESP32.</td></tr>
<tr><td><a href="https://github.com/esp-rs/esp32c3">esp-rs/esp32c3</a></td><td>A PAC crate for the ESP32-C3.</td></tr>
<tr><td><a href="https://github.com/esp-rs/esp32s2">esp-rs/esp32s2</a></td><td>A PAC crate for the ESP32-S2.</td></tr>
<tr><td><a href="https://github.com/esp-rs/esp32s3">esp-rs/esp32s3</a></td><td>A PAC crate for the ESP32-S3.</td></tr>
<tr><td><a href="https://github.com/esp-rs/esp8266-hal">esp-rs/esp8266-hal</a></td><td>An implementation of the <code>embedded-hal</code> traits and more for the ESP8266.</td></tr>
<tr><td><a href="https://github.com/esp-rs/esp8266">esp-rs/esp8266</a></td><td>A PAC crate for the ESP8266.</td></tr>
</tbody></table>
<h2 id="comparing-std-and-no_std"><a class="header" href="#comparing-std-and-no_std">Comparing <code>std</code> and <code>no_std</code></a></h2>
<p>There are a number of factors which must be considered when choosing between the two possible approaches. As stated earlier, each approach has its own unique set of advantages and disadvantages. While we can't decide for you, this section will hopefully allow you to make an educated decision.</p>
<p>At present, there are unfortunately certain technical restrictions which may dictate your choice; we hope to have these issues resolved soon. Currently you <em>must</em> use the <code>std</code> approach if you require any of the following:</p>
<ul>
<li>Use of Wi-Fi or Bluetooth</li>
<li>The ability to target any chip other than the ESP32 or the ESP8266</li>
</ul>
<h3 id="application-runtimes"><a class="header" href="#application-runtimes">Application Runtimes</a></h3>
<p>In the case of applications (as opposed to libraries) the standard library provides a runtime which handles setting up stack overflow protection, spawning the main thread before an application's <code>main</code> function is invoked, and handling of command-line arguments.</p>
<p>Applications targeting <code>no_std</code> will be responsible for initializing their own runtimes instead. Runtime initialization is generally handled by an external dependency, in our case the <a href="https://github.com/rust-embedded/riscv-rt">riscv-rt</a> and <a href="https://github.com/esp-rs/xtensa-lx-rt">xtensa-lx-rt</a> libraries. You can refer to their READMEs and documentation for more information.</p>
<p>One advantage of not including the default runtime is that you're able to write applications at a lower level. This is possible because the applications will have been linked again the <code>core</code> crate instead of <code>std</code>, which makes no assumptions about the system it is running on. As such, it's possible to write applications like bootloaders, firmware, or even operating system kernels using the <code>no_std</code> approach.</p>
<h3 id="no_main"><a class="header" href="#no_main"><code>#![no_main]</code></a></h3>
<p>Another interesting property of <code>no_std</code> applications is that we cannot use Rust's default <code>main</code> function as our entry point. It makes certain assumptions which are not neccessarily valid in an embedded context (for example, it expects that command-line arguments exist).</p>
<p>Because of this, you will often see the <code>#![no_main]</code> attribute used to instruct the Rust compiler not to use the default entry point. Runtime crates will provide an <code>#[entry]</code> attribute which can be used to mark a diverging function as the application's entry point instead. For example a minimal application might look something like this:</p>
<pre><code class="language-rust ignore">#![no_std]
#![no_main]

use riscv_rt::entry;

#[entry]
fn main() -&gt; ! {
    loop {}
}
</code></pre>
<h3 id="panic-handlers"><a class="header" href="#panic-handlers">Panic Handlers</a></h3>
<p>In addition to specifying the application's entry point, for <code>no_std</code> we must also define a panic handler. The default panic behaviour relies on <code>std</code>, as it prints to standard output.</p>
<p>You are able to define a panic handler manually using the <code>#[panic_handler]</code> attribute. Note that this function's signature <em>must</em> match the one below.</p>
<pre><code class="language-rust ignore">#![no_std]

use core::panic::PanicInfo;

#[panic_handler]
fn panic(info: &amp;PanicInfo) -&gt; ! {
    // Your implementation goes here!
}
</code></pre>
<p>Alternatively, there are a number of external dependencies which define various panic handlers for us. Some possible choices are <a href="https://github.com/korken89/panic-halt">panic-halt</a>, <a href="https://github.com/rust-embedded/cortex-m/tree/master/panic-semihosting">panic-semihosting</a>, or <a href="https://github.com/japaric/panic-never">panic-never</a>.</p>
<p>These can be used simply by importing the relevant crate:</p>
<pre><code class="language-rust ignore">#![no_std]

use panic_halt as _;
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="introduction.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="getting-started/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="introduction.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="getting-started/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
